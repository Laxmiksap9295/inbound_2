var oThat;sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/BusyDialog","sap/ui/model/json/JSONModel","sap/ui/model/Filter","ZGT_MM_INBOUND/Util/Formatter","sap/m/MessageToast"],function(e,t,o,a,r,i,n){"use strict";return e.extend("ZGT_MM_INBOUND.controller.Vehicle_Assignment",{onInit:function(){oThat=this;oThat.oView=this.getView();oThat.Core=sap.ui.getCore();oThat.BusyDialog=new o;oThat.oView=this.getView();this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);this.oRouter.getRoute("VehicleAssignment").attachMatched(this._onRouteMatched,this)},_onRouteMatched:function(e){oThat=this;oThat.oView=oThat.getView();oThat.Core=sap.ui.getCore();oThat.oModel=oThat.getOwnerComponent().getModel();if(sap.ui.Device.system.phone){oThat.oDevice="P"}else{oThat.oDevice="D"}oThat.oDataInitial={Items:[{columnKey:"Wbid",text:oThat.oView.getModel("i18n").getResourceBundle().getText("Column1")},{columnKey:"Vehno",text:oThat.oView.getModel("i18n").getResourceBundle().getText("Column4")},{columnKey:"DriverMob",text:oThat.oView.getModel("i18n").getResourceBundle().getText("Column10")},{columnKey:"Erdat",text:oThat.oView.getModel("i18n").getResourceBundle().getText("Column2")},{columnKey:"Ertim",text:oThat.oView.getModel("i18n").getResourceBundle().getText("Column3")}],ColumnsItems:[{columnKey:"Wbid",visible:true,index:0},{columnKey:"Vehno",visible:true,index:1},{columnKey:"DriverMob",visible:true,index:2},{columnKey:"Erdat",visible:false,index:3},{columnKey:"Ertim",visible:false,index:4}]};oThat.oDataBeforeOpen={};oThat.oPersonalModel=new a(jQuery.extend(true,{},oThat.oDataInitial));oThat.oView.setModel(oThat.oPersonalModel);var t={QRCode:true,Manual:false};oThat.oView.setModel(new a(t),"VISI");oThat.aQRCodeArray=[];oThat.oView.setModel(new a(oThat.aQRCodeArray),"POLIST");oThat.Service="HEAD";var o={d:{GateEntry:"",VehAssign:"X",PreQual:"",UnloadConf:"",GateExit:"",Inbound:"X",Outbound:"",IvDelivery:"",IvPo:"",IvWbid:"",IvWerks:"",DelItemNav:[],FifoWbidNav:[],GetReturnNav:[],PoItemNav:[],QualWbidNav:[],WbItemNav:[],WsItemNav:[],WbHeaderNav:[]}};oThat.onCallService(oThat.Service,o)},onCallService:function(e,t){oThat.BusyDialog.open();if(oThat.Service==="HEAD"||oThat.Service==="ITEM"){oThat.oModel.create("/GetHeadersSet",t,{success:oThat.mySuccessHandler,error:oThat.myErrorHandler})}else if(oThat.Service=="VALIDATE"){oThat.oModel.create("/GetHeadersSet",t,{success:oThat.mySuccessHandler,error:oThat.myErrorHandler})}else if(oThat.Service=="SAVE"){oThat.oModel.create("/PostHeadersSet",t,{success:oThat.mySuccessHandler,error:oThat.myErrorHandler})}else if(oThat.Service==="F4MODEL"||oThat.Service==="Plant"||oThat.Service==="Transport"){oThat.oModel.read("/F4ParametersSet",{filters:t,urlParameters:{$expand:"F4DirectionNav,F4ProcessNav,F4PlantNav,F4TransporterNav,F4VehTypeNav"},success:oThat.mySuccessHandler,error:oThat.myErrorHandler})}else if(oThat.Service=="MaterialF4"){oThat.oModel.read("/F4MaterialSet",{filters:t,success:oThat.mySuccessHandler,error:oThat.myErrorHandler})}else if(oThat.Service=="Vendor"){oThat.oModel.read("/F4TransportersSet",{filters:t,success:oThat.mySuccessHandler,error:oThat.myErrorHandler})}},mySuccessHandler:function(e,o){oThat.BusyDialog.close();if(oThat.Service==="HEAD"){oThat.oView.setModel(new a(e),"HEADER");oThat.oView.getModel("HEADER").refresh(true);if(e.FifoWbidNav.length!=0){var i=e.FifoWbidNav.results.length-1;var n=sap.ui.core.format.DateFormat.getDateInstance({pattern:"dd.MM.yyyy"});var l=n.format(e.FifoWbidNav.results[i].Erdat);oThat.oView.byId("id_Today").setText(l);oThat.Service="F4MODEL";var s=[new r("ProcessType",sap.ui.model.FilterOperator.EQ,"X"),new r("Plant",sap.ui.model.FilterOperator.EQ,"X"),new r("Vehtype",sap.ui.model.FilterOperator.EQ,"X")];oThat.onCallService(oThat.Service,s)}}else if(oThat.Service=="VALIDATE"){if(e.GetReturnNav.results.length!=0){var d=e.GetReturnNav.results.filter(function(e){if(e.Type=="E"){return e}});if(d!=0){t.error(d[0].Message)}else{sap.ui.getCore().byId("id_InManual").setValue("");if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text3")){oThat.oView.setModel(new a(e.PoItemNav),"oPoitemModel");oThat.oView.getModel("oPoitemModel").refresh();oThat.oPoItemFrag=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.PoItemList",oThat);oThat.oView.addDependent(oThat.oPoItemFrag);oThat.oPoItemFrag.open()}else if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text21")){e.PoItemNav.results[0].Parnr=sap.ui.getCore().byId("id_Vendor").getValue();oThat.oView.getModel("POLIST").getData().push(e.PoItemNav.results[0]);oThat.oView.getModel("POLIST").refresh(true)}else if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text4")){oThat.oView.setModel(new a(e.DelItemNav),"oPoitemModel");oThat.oView.getModel("oPoitemModel").refresh();oThat.oPoItemFrag=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.DelItemList",oThat);oThat.oView.addDependent(oThat.oPoItemFrag);oThat.oPoItemFrag.open()}}}else{sap.ui.getCore().byId("id_InManual").setValue("");if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text3")){oThat.oView.setModel(new a(e.PoItemNav),"oPoitemModel");oThat.oView.getModel("oPoitemModel").refresh();oThat.oPoItemFrag=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.PoItemList",oThat);oThat.oView.addDependent(oThat.oPoItemFrag);oThat.oPoItemFrag.open()}else if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text21")){e.PoItemNav.results[0].Parnr=sap.ui.getCore().byId("id_Vendor").getValue();oThat.oView.getModel("POLIST").getData().push(e.PoItemNav.results[0]);oThat.oView.getModel("POLIST").refresh(true)}else if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text4")){oThat.oView.setModel(new a(e.DelItemNav),"oPoitemModel");oThat.oView.getModel("oPoitemModel").refresh();oThat.oPoItemFrag=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.DelItemList",oThat);oThat.oView.addDependent(oThat.oPoItemFrag);oThat.oPoItemFrag.open()}}}else if(oThat.Service=="ITEM"){oThat.EvWtype=e.EvWtype;oThat.oView.setModel(new a(e),"ITEM");oThat.oView.getModel("ITEM").refresh(true);if(e.GetReturnNav.results.length!=0){var d=e.GetReturnNav.results.filter(function(e){if(e.Type=="E"){return e}});if(d!=0){var T;for(var u=0;u<d.length;u++){T=d[u].Message+"\n"}t.show(T,{icon:t.Icon.ERROR,title:oThat.oView.getModel("i18n").getResourceBundle().getText("Title21"),actions:[t.Action.OK],onClose:function(e){}})}else{var h=e.GetReturnNav.results.filter(function(e){if(e.Type=="W"){return e}});if(h!=0){for(var u=0;u<h.length;u++){T=h[u].Message+"\n"}t.show(T,{icon:t.Icon.WARNING,title:oThat.oView.getModel("i18n").getResourceBundle().getText("Title22"),actions:[t.Action.OK],onClose:function(e){oThat.VehicleAssign=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.VehicleAssignment",oThat);oThat.oView.addDependent(oThat.VehicleAssign);oThat.VehicleAssign.open();sap.ui.getCore().byId("id_scanid").setState(true)}})}}}else{oThat.VehicleAssign=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.VehicleAssignment",oThat);oThat.oView.addDependent(oThat.VehicleAssign);oThat.VehicleAssign.open()}}else if(oThat.Service=="SAVE"){if(e.PostReturnNav.results.length!=0){var d=e.PostReturnNav.results.filter(function(e){if(e.Type=="E"){return e}});if(d!=0){t.error(d[0].Message)}var g=e.PostReturnNav.results.filter(function(e){if(e.Type=="S"){return e}});if(g!=0){t.success(g[0].Message);e=[];oThat.oView.setModel(new a(e),"ITEM");oThat.oView.getModel("ITEM").refresh(true);oThat.VehicleAssign.destroy();oThat.aQRCodeArray=[];oThat.oView.getModel("POLIST").setData(oThat.aQRCodeArray);oThat.oView.getModel("POLIST").refresh(true);oThat.Service="HEAD";var M={d:{GateEntry:"",VehAssign:"X",PreQual:"",UnloadConf:"",GateExit:"",Inbound:"X",Outbound:"",IvDelivery:"",IvPo:"",IvWbid:"",IvWerks:"",DelItemNav:[],FifoWbidNav:[],GetReturnNav:[],PoItemNav:[],QualWbidNav:[],WbItemNav:[],WsItemNav:[],WbHeaderNav:[]}};oThat.onCallService(oThat.Service,M)}}}else if(oThat.Service==="F4MODEL"){oThat.getOwnerComponent().getModel("F4Model").setData(e);oThat.getOwnerComponent().getModel("F4Model").refresh(true)}else if(oThat.Service==="Transport"){oThat.oView.setModel(new a(e),"oTrnsportModel");oThat.oView.getModel("oTrnsportModel").refresh(true)}else if(oThat.Service=="MaterialF4"){var I=new a(e);I.setSizeLimit(e.length);oThat.oView.setModel(I,"Material")}else if(oThat.Service=="Vendor"){var I=new a(e);I.setSizeLimit(e.length);oThat.oView.setModel(I,"Vendor")}},myErrorHandler:function(e){oThat.BusyDialog.close();var o=oThat.oView.getModel("i18n").getResourceBundle().getText("Title21");t.show(e.responseText,t.Icon.ERROR,o)},onPressVAListItem:function(e){var t=this.getView();var o=this;var a={QRCode:true,Manual:false};o.oView.getModel("VISI").setData(a);o.oView.getModel("VISI").refresh(true);var r=e.getSource().getBindingContextPath();var i=t.getModel("HEADER").getObject(r);var n={d:{GateEntry:"",VehAssign:"X",PreQual:"",UnloadConf:"",GateExit:"",Inbound:"",Outbound:"",IvDelivery:"",IvPo:"",IvWbid:i.Wbid,IvWerks:"",DelItemNav:[],FifoWbidNav:[],GetReturnNav:[],PoItemNav:[],QualWbidNav:[],WbItemNav:[],WsItemNav:[],WbHeaderNav:[]}};o.Service="ITEM";o.onCallService(o.Service,n)},onClickBack:function(){oThat.VehicleAssign.destroy();oThat.aQRCodeArray=[];oThat.oView.getModel("POLIST").setData(oThat.aQRCodeArray);oThat.oView.getModel("POLIST").refresh(true)},onValueHelpPress:function(e){oThat.vId=e.getSource().getId();e.getSource().setValueState("None");if(oThat.vId.indexOf("id_InPlant")!=-1){oThat.ValueHelp=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.Plant",oThat);oThat.oView.addDependent(oThat.ValueHelp);oThat.ValueHelp.open()}else if(oThat.vId.indexOf("id_InGate")!=-1){oThat.ValueHelp=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.Gate",oThat);oThat.oView.addDependent(oThat.ValueHelp);oThat.ValueHelp.open();oThat.Service="GATE";var t=[new r("Werks",sap.ui.model.FilterOperator.EQ,oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Werks),new r("Wbobj",sap.ui.model.FilterOperator.EQ,oThat.EvWtype)];oThat.onCallService(oThat.Service,t)}else if(oThat.vId.indexOf("id_InTransport")!=-1){oThat.ValueHelp=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.Transporter",oThat);oThat.oView.addDependent(oThat.ValueHelp);oThat.ValueHelp.open();if(oThat.vId.indexOf("id_InTransport")!=-1){sap.ui.getCore().byId("id_TranportFrag").setTitle(oThat.oView.getModel("i18n").getResourceBundle().getText("Title7"))}oThat.Service="Transport";var t=[new r("Transporter",sap.ui.model.FilterOperator.EQ,"X")];oThat.onCallService(oThat.Service,t)}else if(oThat.vId.indexOf("id_Vendor")!=-1){oThat.ValueHelp=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.Vendor",oThat);oThat.oView.addDependent(oThat.ValueHelp);oThat.ValueHelp.open();oThat.Service="Vendor";var t=[new r("Werks",sap.ui.model.FilterOperator.EQ,oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Werks)];oThat.onCallService(oThat.Service,t)}else if(oThat.vId.indexOf("id_InManual")!=-1){oThat.ValueHelp=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.MaterialF4",oThat);oThat.oView.addDependent(oThat.ValueHelp);oThat.ValueHelp.open();oThat.Service="MaterialF4";var t=[new r("Werks",sap.ui.model.FilterOperator.EQ,oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Werks)];oThat.onCallService(oThat.Service,t)}},onValueHelpSearch:function(e){var t=e.getParameter("value");var o;if(oThat.vId.indexOf("id_InPlant")!=-1){o=new sap.ui.model.Filter([new r("Werks",sap.ui.model.FilterOperator.Contains,t),new r("Name1",sap.ui.model.FilterOperator.Contains,t)])}else if(oThat.vId.indexOf("id_InGate")!=-1){o=new sap.ui.model.Filter([new r("Gate",sap.ui.model.FilterOperator.Contains,t)])}else if(oThat.vId.indexOf("id_InTransport")!=-1){o=new sap.ui.model.Filter([new r("Parnr",sap.ui.model.FilterOperator.Contains,t),new r("Name1",sap.ui.model.FilterOperator.Contains,t)])}else if(oThat.vId.indexOf("id_Vendor")!=-1){o=new sap.ui.model.Filter([new r("Lifnr",sap.ui.model.FilterOperator.Contains,t),new r("Name1",sap.ui.model.FilterOperator.Contains,t)])}else if(oThat.vId.indexOf("id_InManual")!=-1){o=new sap.ui.model.Filter([new r("Matnr",sap.ui.model.FilterOperator.Contains,t),new r("Maktx",sap.ui.model.FilterOperator.Contains,t)])}var a=new sap.ui.model.Filter(o,false);var i=e.getSource().getBinding("items");i.filter([a])},onValueHelpCancel:function(){oThat.ValueHelp.destroy()},onValueHelpConfirm:function(e){var t=e.getParameter("selectedItem");if(oThat.vId.indexOf("id_InPlant")!=-1){oThat.oView.getModel("POST").getData().WbHeaderNav.results[0].Werks=t.getDescription();oThat.oView.getModel("POST").refresh(true)}else if(oThat.vId.indexOf("id_InGate")!=-1){oThat.oView.getModel("POST").getData().WbHeaderNav.results[0].Gate=t.getTitle()}else if(oThat.vId.indexOf("id_InTransport")!=-1){oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Lifnr=t.getTitle()}else if(oThat.vId.indexOf("id_Vendor")!=-1){oThat.Core.byId("id_Vendor").setValue(t.getDescription())}else if(oThat.vId.indexOf("id_InManual")!=-1){oThat.Core.byId("id_InManual").setValue(t.getTitle())}oThat.oView.getModel("ITEM").refresh(true);oThat.ValueHelp.destroy()},onLiveChange:function(e){oThat.vId=e.getSource().getId();e.getSource().setValueState("None")},onChangeProcess:function(e){var t=e.getSource().getId();var o=e.getSource().getSelectedKey();var a=e.getSource()._getSelectedItemText();if(t.indexOf("id_ComboProcess")!=-1){var r=e.getSource().getModel("F4Model").getData().results[0].F4ProcessNav.results.filter(function(e){return e.Name1==a});oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Wtype=o;if(r.length!=0){if(r[0].Po=="X"){oThat.Core.byId("id_POBtn").setText(oThat.oView.getModel("i18n").getResourceBundle().getText("Text3"));oThat.Core.byId("id_VendorBox").setVisible(false);oThat.Core.byId("id_InManual").setMaxLength(10);oThat.Core.byId("id_InManual").setShowValueHelp(false);oThat.Core.byId("id_InManual").setValue("")}else if(r[0].Po=="M"){oThat.Core.byId("id_POBtn").setText(oThat.oView.getModel("i18n").getResourceBundle().getText("Text21"));oThat.Core.byId("id_VendorBox").setVisible(true);oThat.Core.byId("id_InManual").setMaxLength(18);oThat.Core.byId("id_InManual").setShowValueHelp(true);oThat.Core.byId("id_InManual").setValue("")}else{oThat.Core.byId("id_POBtn").setText(oThat.oView.getModel("i18n").getResourceBundle().getText("Text4"));oThat.Core.byId("id_VendorBox").setVisible(false);oThat.Core.byId("id_InManual").setMaxLength(10);oThat.Core.byId("id_InManual").setShowValueHelp(false);oThat.Core.byId("id_InManual").setValue("")}}}else if(t.indexOf("id_VehicleTy")!=-1){oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Vehtyp=o}oThat.oView.getModel("ITEM").refresh(true)},onSwitchChange:function(e){if(oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Wtype!==""){if(e.getSource().getState()==true){oThat.oView.getModel("VISI").getData().Manual=false;oThat.oView.getModel("VISI").getData().QRCode=true}else{oThat.oView.getModel("VISI").getData().Manual=true;oThat.oView.getModel("VISI").getData().QRCode=false}oThat.oView.getModel("VISI").refresh(true)}else{n.show(oThat.oView.getModel("i18n").getResourceBundle().getText("ErrorMsg17"))}},onScanBarcode:function(e){if(oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Wtype!==""){var t=e.getParameter("text");if(t!=""){var o=t.slice(0,10);oThat.onQRValidate(o)}}else{n.show(oThat.oView.getModel("i18n").getResourceBundle().getText("ErrorMsg17"))}},fnBarcodeFailed:function(){sap.m.MessageBox.error(oThat.oView.getModel("i18n").getResourceBundle().getText("ErrorMsg1"))},onPressManualQROK:function(e){var t=sap.ui.getCore().byId("id_InManual").getValue();if(t==""){n.show(oThat.oView.getModel("i18n").getResourceBundle().getText("ErrorMsg14"))}else{oThat.onQRValidate(t)}},onPressClear:function(e){sap.ui.getCore().byId("id_InManual").setValue("")},onQRValidate:function(e){var t="";var o="";var a="";if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text21")){t="X"}else{t=""}if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text4")){o=e}if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text3")){a=e}var r={d:{GateEntry:"",VehAssign:"X",PreQual:"",UnloadConf:"",GateExit:"",Inbound:"X",Outbound:"",IvDelivery:o,IvPo:a,IvWbid:"",IvMatnr:t,IvWerks:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Werks,DelItemNav:[],FifoWbidNav:[],GetReturnNav:[],PoItemNav:[],QualWbidNav:[],WbItemNav:[],WsItemNav:[],WbHeaderNav:[]}};if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text4")){r.d.DelItemNav.push({Vbeln:e})}else if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text21")){r.d.PoItemNav.push({Matnr:e,Vendor:sap.ui.getCore().byId("id_Vendor").getValue()})}else{r.d.PoItemNav.push({Ebeln:e})}oThat.Service="VALIDATE";oThat.onCallService(oThat.Service,r)},onPressSave:function(e){var o=oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0];try{var a=false;if(o.Werks==""||o.Werks==undefined){a=true;oThat.Core.byId("id_InPlant").setValueState("Error")}if(o.Wtype==""||o.Wtype==undefined){a=true;oThat.Core.byId("id_ComboProcess").setValueState("Error")}if(oThat.EvWtype=="WB"){if(o.Gate==""||o.Gate==undefined){a=true;oThat.Core.byId("id_InGate").setValueState("Error")}}if(oThat.EvWtype=="WS"){if(o.Wsgate==""||o.Wsgate==undefined){a=true;oThat.Core.byId("id_InGate").setValueState("Error")}}if(o.Vehno==""||o.Vehno==undefined){a=true;oThat.Core.byId("id_VehiNo").setValueState("Error")}if(a==true){var r="MN";throw r}else if(oThat.oView.getModel("POLIST").getData().length===0){var r="PO";throw r}else{var i="";var n="";if(oThat.EvWtype=="WB"){i=oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Gate}else{n=oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Wsgate}var l="";if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text21")){l="X"}else{l=""}var s="";var d=e.getSource().getModel("F4Model").getData().results[0].F4ProcessNav.results.filter(function(e){return e.SeqNo==oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Wtype});if(d.length!=0){s=d[0].Process}var T={Werks:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Werks,Lifnr:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Lifnr,Gate:i,Wsgate:n,Vehno:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Vehno,Vehtyp:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Vehtyp,Dname:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Dname,DriverMob:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].DriverMob,Wtype:s,Wbid:oThat.oView.getModel("ITEM").getData().WbHeaderNav.results[0].Wbid};var u={d:{GateEntry:"",VehAssign:"X",PreQual:"",UnloadConf:"",GateExit:"",Inbound:"X",Outbound:"",IvWboj:oThat.EvWtype,IvMatnr:l,PostReturnNav:[],PostWbHeaderNav:[],PostWbitemNav:[],PostWsItemNav:[]}};u.d.PostWbHeaderNav.push(T);if(oThat.oView.getModel("POLIST").getData().length!=0){oThat.oView.getModel("POLIST").getData().forEach(function(e){var t="00000";var o="000000";var a="";var r="";var i="";if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text4")){t="00000";o=e.Posnr;r=e.Vbeln;i=e.Werks}else if(sap.ui.getCore().byId("id_POBtn").getText()===oThat.oView.getModel("i18n").getResourceBundle().getText("Text21")){t="00000";o="000000";i=e.Parnr}else{o="000000";t=e.Ebelp;a=e.Ebeln;i=e.Parnr}if(oThat.EvWtype=="WB"){u.d.PostWbitemNav.push({Ebeln:a,Ebelp:t,Matnr:e.Matnr,Parnr:i,Item:e.Item,Vbeln:r,Posnr:o,Brgew:"0",Gdate:null,Gtime:"PT00H00M00S",Sgdate:null,Sgtime:"PT00H00M00S",Trwgt:"0",Tdate:null,Ttime:"PT00H00M00S",Stdate:null,Sttime:"PT00H00M00S",Ntgew:"0.000",Pkwgt:"0.000",Menge:"0.000",Pmatno1:"0.000",Pmatqty1:"0.000",Trwgt1:"0.000",Pmatno2:"0.000",Pmatqty2:"0.000",Trwgt2:"0.000",Pmatno3:"0.000",Pmatqty3:"0.000",Trwgt3:"0.000",Pmatno4:"0.000",Pmatqty4:"0.000",Trwgt4:"0.000",Actweight:"0.000",Config2:"0.00",Config8:"0.00",Zeile:"0000"})}else{u.d.PostWsItemNav.push({Vbeln:r,Matnr:e.Matnr,Posnr:o,Item:e.Item,Parnr:i,Ebelp:t,Ebeln:a,Pmatno1:"0",Pmatqty1:"0.000",Trwgt1:"0.000",Pmatno2:"0.000",Pmatqty2:"0.000",Trwgt2:"0.000",Pmatno3:"0.000",Pmatqty3:"0.000",Trwgt3:"0.000",Pmatno4:"0.000",Pmatqty4:"0.000",Trwgt4:"0.000",Bgtrwt:"0.000",Brgew:"0.000",Ntgew:"0.000",Gdate:null,Gtime:"PT00H00M00S",Sgdate:null,Sgtime:"PT00H00M00S",Erdat:null,Ertim:"PT00H00M00S",Aedat:null,Aetim:"PT00H00M00S",Config8:"0.00",Config2:"0.00",Zeile:"0000"})}})}oThat.Service="SAVE";oThat.onCallService(oThat.Service,u)}}catch(r){if(r=="MN"){t.error(oThat.oView.getModel("i18n").getResourceBundle().getText("ErrorMsg1"))}else if(r=="PO"){t.error(oThat.oView.getModel("i18n").getResourceBundle().getText("ErrorMsg13"))}}},onClosePoIteList:function(e){t.show(oThat.oView.getModel("i18n").getResourceBundle().getText("ConfirmMsg1"),{icon:t.Icon.INFORMATION,title:oThat.oView.getModel("i18n").getResourceBundle().getText("Title16"),actions:[t.Action.YES,t.Action.NO],onClose:function(e){if(e==="YES"){var t=sap.ui.getCore().byId("id_PoItemList").getSelectedItems();if(t.length!=0){for(var o=0;o<t.length;o++){var a=t[o].getBindingContext("oPoitemModel").getPath();oThat.oView.getModel("oPoitemModel").setProperty(a+"/Parnr",sap.ui.getCore().byId("id_Vendor").getValue());oThat.oView.getModel("oPoitemModel").refresh();oThat.oView.getModel("POLIST").getData().push(t[o].getBindingContext("oPoitemModel").getObject())}}oThat.oView.getModel("POLIST").refresh();oThat.oPoItemFrag.destroy()}}})},onOpenPOList:function(){oThat.POList=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.PoList",oThat);oThat.oView.addDependent(oThat.POList);oThat.POList.open()},onClosePoList:function(){oThat.POList.destroy()},onSettings:function(){oThat.PersonalizeFrag=sap.ui.xmlfragment("ZGT_MM_INBOUND.Fragments.Personalize",oThat);oThat.oView.addDependent(oThat.PersonalizeFrag);oThat.oDataBeforeOpen=jQuery.extend(true,{},oThat.oPersonalModel.getData());oThat.PersonalizeFrag.open()},onCancel:function(){oThat.oPersonalModel.setProperty("/",jQuery.extend(true,[],oThat.oDataBeforeOpen));oThat.oDataBeforeOpen={};oThat.PersonalizeFrag.close()},onOK:function(e){oThat.PersonalizeFrag.close()},onNavBack:function(){this.oRouter.navTo("Inbound")}})});
//# sourceMappingURL=Vehicle_Assignment.controller.js.map